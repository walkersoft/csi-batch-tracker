<Window x:Class="CSI.BatchTracker.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:xceed="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:input="http://schemas.microsoft.com/expression/2010/interactivity"
        xmlns:local="clr-namespace:CSI.BatchTracker.Views"
        mc:Ignorable="d"
        SizeToContent="WidthAndHeight"
        ResizeMode="NoResize"
        Title="{Binding WindowTitle}">
    <StackPanel Orientation="Vertical">
        <Menu Margin="0,0,0,5" Background="#FFE0EFFF">
            <MenuItem Header="_File">
                <MenuItem Header="_Close" InputGestureText="Alt+F4"/>
            </MenuItem>
            <MenuItem Header="_Batch Management">
                <MenuItem Header="_Receiving Session" Command="{Binding LaunchReceivingManagementSessionViewerCommand}"/>
                <MenuItem Header="Receiving _History" Command="{Binding LaunchReceivingHistorySessionViewerCommand}"/>
                <MenuItem Header="Individual _Batch History" Command="{Binding LaunchBatchHistoryViewerCommand}"/>
            </MenuItem>
            <MenuItem Header="_People">
                <MenuItem Header="Batch _Operator Management" Command="{Binding LaunchBatchOperatorManagementSessionViewerCommand}"/>
            </MenuItem>
            <MenuItem Header="Data Source">
                <MenuItem Header="Attach Database" Click="AttachDatabase"/>
                <MenuItem Header="Create Database Backup" Click="CreateDatabaseBackup"/>
            </MenuItem>
            <MenuItem Header="_Demo Tools">
                <MenuItem Header="Populate Data Sources" Command="{Binding LaunchDataSourcePopulatorCommand}"/>
            </MenuItem>
        </Menu>

        <WrapPanel Orientation="Horizontal" Margin="5">
            <StackPanel Orientation="Vertical">
                <WrapPanel Orientation="Horizontal">
                    <Label Content="Current Inventory" FontWeight="Bold"/>
                    <Label Content="(Total Inventory Items: " Padding="0,5,0,5"/>
                    <Label Content="{Binding TotalInventoryCount}" Padding="0,5,0,5"/>
                    <Label Content=")" Padding="0,5,0,5"/>
                </WrapPanel>
                <DataGrid AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False"
                          CanUserSortColumns="False"
                          IsReadOnly="True"
                          MinHeight="200"
                          MaxHeight="200"
                          HeadersVisibility="Column"
                          HorizontalContentAlignment="Stretch"
                          VerticalScrollBarVisibility="Visible"
                          ItemsSource="{Binding CurrentInventory}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Color Name" Width="120" Binding="{Binding ColorName}"/>
                        <DataGridTextColumn Header="Batch Number" Width="120" Binding="{Binding BatchNumber}"/>
                        <DataGridTextColumn Header="Quantity" Width="80" Binding="{Binding Quantity}"/>
                    </DataGrid.Columns>
                </DataGrid>

                <Label Content="Average Usage (Last 30 days)" FontWeight="Bold"/>
                <DataGrid AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False"
                          CanUserSortColumns="False"
                          IsReadOnly="True"                          
                          MinHeight="200"
                          MaxHeight="200"
                          HeadersVisibility="Column"
                          HorizontalContentAlignment="Stretch"
                          ItemsSource="{Binding AverageBatchList}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Color Name" Width="120" Binding="{Binding ColorName}"/>
                        <DataGridTextColumn Header="Qty. Used" Width="80" Binding="{Binding QuantityUsed}"/>
                        <DataGridTextColumn Header="Avg. Daily Usage" Width="130" Binding="{Binding DisplayUsage}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>

            <StackPanel Orientation="Horizontal">
                <Rectangle VerticalAlignment="Stretch" Width="1" Stroke="Gray" Margin="5,0,5,0"/>
            </StackPanel>

            <StackPanel Orientation="Vertical">
                <Label Content="Implement Batch" FontWeight="Bold"/>
                <WrapPanel Orientation="Horizontal">
                    <StackPanel Orientation="Vertical" Margin="0,0,5,0">
                        <Label Content="Batch"/>
                        <ComboBox Width="160" 
                                  SelectedIndex="{Binding ImplementableBatchSelectedIndex}"
                                  ItemsSource="{Binding CurrentInventory}"
                                  DisplayMemberPath="DisplayName">
                            <ComboBox.InputBindings>
                                <KeyBinding Key="Return" Command="{Binding CommitInventoryBatchToImplementationLedgerCommand}"/>
                            </ComboBox.InputBindings>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Margin="0,0,5,0">
                        <Label Content="Implementation Date &amp; Time"/>
                        <xceed:DateTimePicker Width="270" Height="22" Value="{Binding ImplementationDateTime}">
                            <xceed:DateTimePicker.InputBindings>
                                <KeyBinding Key="Return" Command="{Binding CommitInventoryBatchToImplementationLedgerCommand}"/>
                            </xceed:DateTimePicker.InputBindings>
                        </xceed:DateTimePicker>
                    </StackPanel>
                    <StackPanel Orientation="Vertical" Margin="0,0,5,0">
                        <Label Content="Implementing Operator"/>
                        <ComboBox Width="130"
                                  SelectedIndex="{Binding ImplementingBatchOperatorSelectedIndex}"
                                  ItemsSource="{Binding OperatorRepository}"
                                  DisplayMemberPath="FullName">
                            <ComboBox.InputBindings>
                                <KeyBinding Key="Return" Command="{Binding CommitInventoryBatchToImplementationLedgerCommand}"/>
                            </ComboBox.InputBindings>
                        </ComboBox>
                    </StackPanel>
                    <Button VerticalAlignment="Bottom" 
                            Width="100" 
                            Content="Commit Batch"
                            Command="{Binding CommitInventoryBatchToImplementationLedgerCommand}"/>
                </WrapPanel>

                <Label Content="Implementation Ledger (Last 30 days)" FontWeight="Bold"/>
                <DataGrid AutoGenerateColumns="False"
                          CanUserAddRows="False"
                          CanUserDeleteRows="False"
                          CanUserReorderColumns="False"
                          CanUserSortColumns="False"
                          IsReadOnly="True"
                          MinHeight="320"
                          MaxHeight="320"
                          Margin="0,0,0,5"
                          HeadersVisibility="Column"
                          VerticalScrollBarVisibility="Visible"
                          VerticalContentAlignment="Stretch"
                          ItemsSource="{Binding ImplementedBatchLedger}"
                          SelectedIndex="{Binding ImplementedBatchSelectedIndex}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Color Name" Width="120" Binding="{Binding ColorName}"/>
                        <DataGridTextColumn Header="Batch Number" Width="150" Binding="{Binding BatchNumber}"/>
                        <DataGridTextColumn Header="Date Implemented" Width="170" Binding="{Binding ActivityDate}"/>
                        <DataGridTextColumn Header="Implementing Operator" Width="170" Binding="{Binding ImplementingOperator.FullName}"/>
                    </DataGrid.Columns>
                    <DataGrid.InputBindings>
                        <MouseBinding 
                            MouseAction="LeftDoubleClick"
                            Command="{Binding LaunchBatchHistoryViewerWithBatchNumberCommand}"/>
                    </DataGrid.InputBindings>
                </DataGrid>
                <WrapPanel Orientation="Horizontal">
                    <Button Content="Return Selected Batch to Inventory" 
                            Width="230" 
                            HorizontalAlignment="Left" 
                            Margin="0,0,5,0"
                            Command="{Binding UndoSelectedImplementedBatchCommand}"/>
                    <Button Content="View History of Selected Batch" 
                            Width="230" 
                            HorizontalAlignment="Left" 
                            Margin="0,0,5,0"
                            Command="{Binding LaunchBatchHistoryViewerWithBatchNumberCommand}"/>
                </WrapPanel>
            </StackPanel>
        </WrapPanel>
    </StackPanel>
</Window>
